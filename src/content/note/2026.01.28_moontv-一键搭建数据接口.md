---
title: MoonTv 一键搭建数据接口
description: 这是一篇有意思的文章
publishDate: 2026-01-28T09:20
---
使用方法：\
这个链接是你自己cf部署的访问链接，记得加/?\
https://moontv.gyx.workers.dev/?
下面这个示例链接是需要转编码的链接
url=https://raw.githubusercontent.com/666zmy/MoonTV/refs/heads/main/config.json&pretty=true

下面是CF部署的wokes代码，从哈喽wokers开始去编辑复制粘贴
 

```
addEventListener('fetch', event => {
  event.respondWith(handleRequest(event.request))
})

async function handleRequest(request) {
  try {
    // 解析 URL 参数
    const url = new URL(request.url)
    const targetUrl = url.searchParams.get('url')
    
    if (!targetUrl) {
      return new Response('Missing url parameter', { status: 400 })
    }
    
    // 验证 URL 格式
    try {
      new URL(targetUrl)
    } catch {
      return new Response('Invalid URL format', { status: 400 })
    }
    
    // 从远程获取 JSON
    const response = await fetch(targetUrl)
    
    if (!response.ok) {
      return new Response(`Failed to fetch: ${response.status}`, { status: response.status })
    }
    
    const jsonData = await response.json()
    
    // 对 JSON 做 base58 编码
    const jsonString = JSON.stringify(jsonData)
    const encoded = base58Encode(jsonString)
    
    return new Response(encoded, {
      headers: {
        'Content-Type': 'text/plain',
        'Access-Control-Allow-Origin': '*'
      }
    })
    
  } catch (error) {
    return new Response(`Error: ${error.message}`, { status: 500 })
  }
}

// Base58 编码实现
function base58Encode(str) {
  const ALPHABET = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'
  const bytes = new TextEncoder().encode(str)
  
  if (bytes.length === 0) return ''
  
  let num = BigInt('0x' + Array.from(bytes).map(b => b.toString(16).padStart(2, '0')).join(''))
  
  if (num === 0n) return ALPHABET[0]
  
  let result = ''
  while (num > 0n) {
    result = ALPHABET[Number(num % 58n)] + result
    num = num / 58n
  }
  
  // 处理前导零
  for (let i = 0; i < bytes.length && bytes[i] === 0; i++) {
    result = ALPHABET[0] + result
  }
  
  return result
}
```
